---
phase: 07-module-3-content
plan: 06
type: execute
wave: 4
depends_on: ["07-01"]
files_modified: [src/components/visualizations/diagrams/LiquidityCrisisFlow.tsx, src/components/visualizations/diagrams/VaRDistribution.tsx, src/components/visualizations/diagrams/RiskTypesPentagon.tsx]
autonomous: true
---

<objective>
Create Liquidity Crisis Flow, VaR Distribution, and Risk Types Pentagon visualizations.

Purpose: Illustrate liquidity risk mechanics (bank run → fire sale), market risk measurement (VaR), and the five main bank risk categories.
Output: Three interactive visualization components for Lessons 3-2.4, 3-2.5, and the overall risk overview.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-module-3-content/07-01-SUMMARY.md

# Pattern reference:
@src/components/visualizations/diagrams/OffBalanceSheetIceberg.tsx
@src/components/visualizations/diagrams/IncomeStatementWaterfall.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Liquidity Crisis Flow visualization</name>
  <files>src/components/visualizations/diagrams/LiquidityCrisisFlow.tsx</files>
  <action>
Create a step-by-step visualization of a liquidity crisis:

**Crisis Timeline (animated sequence):**

Step 1: Normal State
- Balance sheet: Cash (10), Securities (20), Loans (70) | Deposits (90), Equity (10)
- All balanced, healthy

Step 2: Confidence Loss
- News/rumor triggers concern
- "Trust is fragile" message
- Animated worry icons

Step 3: Bank Run Begins
- Depositors line up (animated figures)
- Withdrawals spike: 40 units
- Cash depletes first

Step 4: Liability Management Fails
- Markets close to bank
- "Wholesale funding unavailable"
- Rollover denied

Step 5: Fire Sale
- Must sell assets at discount
- Loans worth 20 sold for 15
- Loss = 5 (book value - sale price)
- Animated price crash

Step 6: Equity Absorbs Loss
- Equity shrinks: 10 → 5
- If losses > equity → Insolvency
- Color shift to red

**Interactive Controls:**
- "Play Crisis" button to animate through steps
- Step-by-step navigation (forward/back)
- "Reset" to normal state

**Balance Sheet Display:**
- Animated waterfall showing changes at each step
- Running totals for Assets, Liabilities, Equity
- Highlight fire sale discount

**Key Concepts Panel:**
- Cash Shortfall = Outflows - Inflows
- Fire Sale Loss = Book Value - Sale Price
- Liquidity → Solvency contagion

Use existing animation patterns.
Dark/urgent color scheme for crisis steps.
  </action>
  <verify>npm run build succeeds, crisis animation plays through all steps</verify>
  <done>Animated liquidity crisis flow with 6 steps and balance sheet updates</done>
</task>

<task type="auto">
  <name>Task 2: Create VaR Distribution visualization</name>
  <files>src/components/visualizations/diagrams/VaRDistribution.tsx</files>
  <action>
Create a visualization explaining Value at Risk (VaR):

**Main Visual: P&L Distribution Histogram**
- X-axis: Daily P&L (losses on left, gains on right)
- Y-axis: Frequency/Probability
- Bell curve (or slightly fat-tailed) distribution
- Center at 0 (expected daily P&L)

**VaR Cutoff Line:**
- Vertical line at VaR threshold (e.g., -$10M)
- Shaded area to left = "tail risk" (e.g., 1% probability)
- Label: "99% VaR = $10M"
- Meaning: "99% of days, losses won't exceed $10M"

**Interactive Controls:**
- Confidence level slider: 95%, 99%, 99.9%
- As confidence increases, VaR threshold moves further left
- Display: "With X% confidence, worst daily loss is $Y"

**Fat Tails Demonstration:**
- Toggle: "Normal Distribution" vs "Fat Tails"
- Fat tails: more probability mass in extremes
- Show how VaR underestimates tail risk

**Black Swan Callout:**
- Point beyond VaR showing "1 in 100" or "1 in 1000" events
- 2008 crisis as example: losses far exceeded VaR
- "VaR tells you the threshold, not how bad it can get"

**Bet Comparison (from lecture):**
- Two investments, same expected return
- Bet A: 50% chance -$100, 50% chance +$300
- Bet B: 10% chance -$800, 80% chance +$0, 10% chance +$1000
- Show distributions side by side
- Same expected value, different VaR

Use SVG for histogram.
Animate distribution curve drawing on mount.
Smooth transitions when confidence level changes.
  </action>
  <verify>npm run build succeeds, confidence slider updates VaR cutoff correctly</verify>
  <done>VaR distribution with confidence slider, fat tails toggle, and bet comparison</done>
</task>

<task type="auto">
  <name>Task 3: Create Risk Types Pentagon visualization</name>
  <files>src/components/visualizations/diagrams/RiskTypesPentagon.tsx</files>
  <action>
Create a pentagon/radar chart showing the five main bank risk types:

**Main Visual: Pentagon Shape**
Five points representing:
1. Credit Risk (borrower default)
2. Interest Rate Risk (maturity mismatch)
3. Liquidity Risk (cash shortfall)
4. Market Risk (trading losses)
5. Operational Risk (system/people failures)

**Interactive Features:**
- Click on each point to expand details panel
- Hover shows brief definition
- Active point highlighted with glow

**Detail Panels (on click):**

Credit Risk:
- Definition: Risk borrowers don't repay
- Key metric: Probability of Default
- Tools: Screening, pricing, covenants, CDS

Interest Rate Risk:
- Definition: Rate changes affect profits
- Key metric: Duration gap
- Tools: Swaps, matching

Liquidity Risk:
- Definition: Cash shortfall risk
- Key metric: Liquidity coverage ratio
- Tools: Asset/liability management

Market Risk:
- Definition: Trading book losses
- Key metric: VaR
- Tools: Limits, hedging

Operational Risk:
- Definition: Process/system failures
- Key metric: Hard to quantify
- Tools: Controls, governance

**Insolvency at Center:**
- All risks connect to central "Insolvency Risk"
- "When any risk exceeds equity buffer"
- Pulsing alert indicator

**Bank Example Mode:**
- Toggle to show example bank's risk profile
- Radar chart filled showing relative exposure
- E.g., Money Center bank: high market risk, high operational
- Community bank: high credit risk, low market risk

Use SVG for pentagon shape.
Smooth rotation on hover/click.
Color each risk type distinctly.
  </action>
  <verify>npm run build succeeds, each risk point expands correct detail panel</verify>
  <done>Interactive risk pentagon with expandable details and bank profile mode</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] LiquidityCrisisFlow animates through all 6 crisis steps
- [ ] Balance sheet updates correctly at each step
- [ ] VaRDistribution shows proper histogram with VaR cutoff
- [ ] Confidence slider updates VaR threshold correctly
- [ ] Fat tails toggle shows difference from normal distribution
- [ ] RiskTypesPentagon shows all 5 risk types
- [ ] Click expands correct detail panel for each risk
- [ ] No TypeScript errors
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Liquidity crisis mechanics clearly visualized
- VaR concept intuitive from visual
- Risk types organized and explorable
</success_criteria>

<output>
After completion, create `.planning/phases/07-module-3-content/07-06-SUMMARY.md`
</output>
